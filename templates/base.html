<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>{% block title %}{{ page_title or "NIRD Campus" }}{% endblock %}</title>
  <meta name="description" content="{% block description %}{{ page_description or "Guide opérationnel NIRD Campus." }}{% endblock %}">
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    body{
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
      font-size:16px; line-height:1.8;
      color:#000; background:#fff;
      margin:0; padding:2rem 1rem;
    }
    .wrapper{width:min(1200px,100%); margin:0 auto;}
    .readable{max-width:80ch;}

    a{color:#0066cc; text-decoration:none; border-bottom:2px solid #0066cc;}
    a:visited{color:#663399; border-bottom-color:#663399;}
    a:hover,a:focus{background:#0066cc; color:#fff; outline:none;}

    h1{font-size:1.6rem; font-weight:800; color:#cc0066; margin-bottom:.5rem; line-height:1.3;}
    h2{font-size:1.25rem; font-weight:700; color:#009966; margin:2rem 0 1rem; line-height:1.3;}
    h3{font-size:1.05rem; font-weight:700; color:#cc6600; margin:1.5rem 0 .5rem; line-height:1.3;}

    p{margin-bottom:1rem;}
    pre{
      background:#f5f5f5;
      border-left:4px solid #cc0066;
      padding:1rem;
      overflow-x:auto;
      margin:1rem 0;
      color:#333;
      white-space:pre-wrap;
    }
    blockquote{
      border-left:4px solid #009966;
      padding-left:1rem;
      margin:1rem 0;
      font-style:italic;
      color:#333;
    }
    hr{border:none; border-top:3px solid #cc0066; margin:2rem 0;}

    /* Accessibilité : lien d’évitement */
    .skip-link{
      position:absolute; left:-999px; top:auto;
      width:1px; height:1px; overflow:hidden;
    }
    .skip-link:focus{
      position:static; width:auto; height:auto;
      display:inline-block;
      margin-bottom:1rem;
      padding:.5rem 1rem;
      border:2px solid #cc0066;
      background:#fff;
      color:#000;
    }

    /* Header commun */
    .site-header{
      padding-bottom:1rem;
      margin-bottom:1.5rem;
      border-bottom:3px solid #009966;
    }
    .site-brand{margin:0 0 .75rem 0;}
    .brand-link{
      font-weight:900;
      color:#cc0066;
      border-bottom:none;
    }
    .brand-link:hover,.brand-link:focus{
      background:transparent;
      color:#cc0066;
      text-decoration:underline;
    }
    .brand-tagline{
      display:block;
      color:#333;
      margin-top:.25rem;
    }
    .site-nav a{
      display:inline-block;
      margin-right:1.25rem;
      font-weight:700;
    }
    .site-nav a[aria-current="page"]{
      text-decoration:underline;
      border-bottom:none;
    }

    .nav-list{list-style:none; margin:1rem 0;}
    .nav-list li::before{content:"→ "; color:#cc0066; font-weight:700;}
    ul{list-style:none; margin:1rem 0;}
    ul li::before{content:"• "; color:#cc0066; font-weight:700;}

    .info{background:#e6f2ff; border:2px solid #0066cc; padding:1rem; margin:1rem 0;}
    .success{background:#e6ffe6; border:2px solid #009966; padding:1rem; margin:1rem 0;}
    .warning{background:#fff9e6; border:2px solid #ffcc00; padding:1rem; margin:1rem 0;}

    /* Médias optionnels */
    .media-link{
      display:inline-block;
      padding:.5rem 1rem;
      background:#ffcc00;
      color:#000;
      border:2px solid #cc6600;
      font-weight:700;
      margin:.5rem 0;
      cursor:pointer;
    }
    .media-link:hover,.media-link:focus{
      background:#cc6600; color:#fff;
      outline:3px solid #ffcc00; outline-offset:2px;
    }
    .media-link:disabled{background:#ccc; border-color:#999; cursor:not-allowed;}
    .media-container{display:none; margin:1rem 0; padding:1rem; background:#f5f5f5; border:2px solid #cc6600;}
    .media-container.loaded{display:block;}
    .media-container img{max-width:100%; height:auto; display:block;}

    footer{margin-top:3rem; padding-top:1rem; border-top:3px solid #cc0066; color:#666;}
    *:focus{outline:3px solid #cc0066; outline-offset:2px;}
  </style>
</head>

<body id="haut">
  <div class="wrapper">
    <div class="readable">

      <a class="skip-link" href="#contenu">Aller au contenu</a>

      <header class="site-header" role="banner">
        <p class="site-brand">
          <a class="brand-link" href="{{ url_for('index') }}" aria-label="NIRD Campus — Accueil">NIRD Campus</a>
          <span class="brand-tagline">Guide opérationnel pour un numérique inclusif, responsable et durable</span>
        </p>

        <nav class="site-nav" aria-label="Navigation principale">
          <a href="{{ url_for('index') }}" accesskey="1" {% if active=="index" %}aria-current="page"{% endif %}>Accueil</a>
          <a href="{{ url_for('demarche') }}" accesskey="2" {% if active=="demarche" %}aria-current="page"{% endif %}>Démarche</a>
          <a href="{{ url_for('reconditionnement') }}" accesskey="3" {% if active=="reconditionnement" %}aria-current="page"{% endif %}>Reconditionnement</a>
          <a href="{{ url_for('collectivites') }}" accesskey="4" {% if active=="collectivites" %}aria-current="page"{% endif %}>Collectivités</a>
          <a href="{{ url_for('assistant') }}" accesskey="5" {% if active=="assistant" %}aria-current="page"{% endif %}>Assistant (IA)</a>

        </nav>
      </header>

      <main id="contenu" role="main">
        {% if content_override %}
          {{ content_override|safe }}
        {% else %}
          {% block content %}{% endblock %}
        {% endif %}
      </main>

      <footer>
        <p>
          ══════════════════════════════════<br>
          NIRD Campus • Guide public • Aucune collecte de données<br>
          Clavier : Tab / Shift+Tab • Raccourcis : Alt+1..4 (selon navigateur)<br>
          ══════════════════════════════════
        </p>
      </footer>

      <script>
        // Média optionnel : aucun téléchargement tant que l’utilisateur ne clique pas.
        (function () {
          const buttons = Array.from(document.querySelectorAll('button.media-link[data-target][data-src]'));
          buttons.forEach((btn) => {
            btn.addEventListener('click', () => {
              const container = document.getElementById(btn.dataset.target);
              if (!container) return;

              const img = container.querySelector('img');
              if (!img) return;

              const err = container.querySelector('.media-error') || document.getElementById(btn.dataset.target + '-error');

              if (container.classList.contains('loaded')) return;
              container.classList.add('loaded');

              img.onload = function () {
                btn.textContent = '[MEDIA] Image chargée ✓';
                btn.disabled = true;
              };

              img.onerror = function () {
                if (err) {
                  err.style.display = 'block';
                  err.innerHTML = '<strong>Erreur :</strong> média introuvable. Vérifiez <code>' + btn.dataset.src + '</code>.';
                }
                btn.textContent = '[MEDIA] Échec de chargement ✗';
              };

              img.src = btn.dataset.src;
            });
          });
        })();
      </script>

    </div>
  </div>
</body>
</html>
